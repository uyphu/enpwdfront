{"version":3,"sources":["../../src/pages/add-secret/add-secret.module.ts","../../src/pages/add-secret/add-secret.ts"],"names":[],"mappings":"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","file":"3.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { AddSecret } from './add-secret';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AddSecret,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(AddSecret),\r\n  ],\r\n  exports: [\r\n    AddSecret\r\n  ]\r\n})\r\nexport class AddSecretModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-secret/add-secret.module.ts","import { OnInit, Component } from '@angular/core';\r\nimport { AlertController, IonicPage, NavController, NavParams, LoadingController, Loading } from 'ionic-angular';\r\n\r\nimport {FormGroup, FormBuilder, FormControl, Validators} from \"@angular/forms\";\r\nimport { Storage } from '@ionic/storage';\r\nimport { DefaultApi } from '../../providers/api/DefaultApi';\r\nimport { Utils } from '../../utils/utils';\r\n\r\nimport * as models  from '../../providers/model/models';\r\nimport * as CryptoJS from 'crypto-js/crypto-js';\r\n\r\n/**\r\n * Generated class for the AddSecret page.\r\n *\r\n * See http://ionicframework.com/docs/components/#navigation for more info\r\n * on Ionic pages and navigation.\r\n */\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-add-secret',\r\n  templateUrl: 'add-secret.html',\r\n})\r\nexport class AddSecret implements OnInit {\r\n\r\n  loading: Loading;\r\n  private addForm: FormGroup;\r\n  SECERET_KEY: string = '';\r\n  submitAttempt: boolean = false;\r\n\r\n  secret: {userId: string, domain: string, username: string, password: string, confirmPassword: string, encryptedPassword: string, note: string, secretKey: string} = \r\n          {userId: '', domain: '', username: '', password: '', confirmPassword: '', encryptedPassword: '', note: '', secretKey: ''};\r\n\r\n  constructor(public navCtrl: NavController, public navParams: NavParams, private alertCtrl: AlertController,\r\n  \tpublic formBuilder: FormBuilder, private api: DefaultApi, private loadingCtrl: LoadingController, private storage: Storage\r\n    ) {\r\n    \r\n  }\r\n\r\n  ngOnInit(): any {\r\n\r\n    this.storage.get('user').then((val) => {\r\n      let loginUser: models.LoginUserResponse = val;\r\n      this.SECERET_KEY = loginUser.item.secretKey;\r\n      this.secret.userId = loginUser.item.id;      \r\n      this.api.configuration = Utils.getConfiguration(loginUser);     \r\n    });\r\n\r\n    this.addForm = this.formBuilder.group({\r\n      domain: ['', [Validators.required, Validators.minLength(3)]],\r\n      username: ['', [Validators.required]],\r\n      password: ['', [Validators.required]],\r\n      confirmPassword: ['', [Validators.required, this.confirmPasswordValidator.bind(this)]],\r\n      encryptedPassword: ['', [Validators.required]],\r\n      note: ['', [Validators.required]],\r\n    });\r\n\r\n  }\r\n\r\n  onSubmit() {\r\n    this.showLoading();\r\n    if (this.addForm.dirty && this.addForm.valid == true) {\r\n      var request: models.InsertSecretRequest = {} as models.InsertSecretRequest;\r\n      request.userId = this.secret.userId;\r\n      request.domain = this.secret.domain;\r\n      request.username = this.secret.username;\r\n      request.password = this.secret.encryptedPassword;    \r\n      request.note = this.secret.note;  \r\n      \r\n      this.api.secretsPost(request).subscribe(response => {        \r\n          this.navCtrl.push('HomePage');\r\n        },\r\n          error => {\r\n            this.showError(error);     \r\n        });\r\n\r\n    } else {\r\n      this.showError('Please fix the error field.');\r\n    }   \r\n  }\r\n\r\n  inputTestData() {\r\n    var request: models.InsertSecretRequest = {} as models.InsertSecretRequest;\r\n    for (var i = 0; i < 40; i++) {\r\n      request.userId = this.secret.userId;\r\n      request.domain = 'domain' + i;\r\n      request.username = 'username' + i;\r\n      var ciphertext = CryptoJS.AES.encrypt('password' + i, this.SECERET_KEY);\r\n      request.password = ciphertext.toString();   \r\n      request.note = 'note' + i;\r\n\r\n      this.api.secretsPost(request).subscribe(response => {        \r\n          //this.navCtrl.push('HomePage');\r\n          //console.log(response);\r\n        },\r\n          error => {\r\n            this.showError(error);\r\n          \r\n        });\r\n    }\r\n  }\r\n\r\n  isValid(field: string) {\r\n    let formField = this.addForm.controls[field];\r\n    if (formField !== undefined) {\r\n      return formField.valid || formField.pristine;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  domainValidator(control: FormControl): {[s: string]: boolean} {\r\n    if (control.value !== '') {\r\n      console.log('domainValidator:' + control.valid);\r\n      return {invalidDomain: true};\r\n    }\r\n  }\r\n\r\n  usernameValidator(control: FormControl): {[s: string]: boolean} {\r\n    if (control.value !== '') {\r\n      return {invalidUsername: true};\r\n    }\r\n  }\r\n\r\n  passwordValidator(control: FormControl): {[s: string]: boolean} {\r\n    if (control.value !== '') {      \r\n        return {invalidPassword: true};      \r\n    }\r\n  }\r\n\r\n  confirmPasswordValidator(control: FormControl): {[s: string]: boolean} {\r\n    if (control !== undefined) {\r\n      if (control.value !== this.secret.password) {\r\n        return {invalidConfirmPassord: true};\r\n      }\r\n    }\r\n  }\r\n\r\n  noteValidator(control: FormControl): {[s: string]: boolean} {\r\n        return {invalidNote: true};\r\n  }\r\n\r\n  onInputTime(password: string){\r\n  \tthis.setPasswordEncrypted(password);\r\n    //console.log(this.getPasswordEcrypted(this.secret.encryptedPassword));\r\n  }\r\n\r\n  getPasswordEcrypted(pwd: string): string {\r\n    // Decrypt \r\n    var bytes = CryptoJS.AES.decrypt(pwd.toString(), this.SECERET_KEY);\r\n    var plaintext = bytes.toString(CryptoJS.enc.Utf8);\r\n    return plaintext;\r\n  }\r\n\r\n  setPasswordEncrypted(pwd: string): void {\r\n    // Encrypt \r\n    var ciphertext = CryptoJS.AES.encrypt(pwd, this.SECERET_KEY);\r\n    this.secret.encryptedPassword = ciphertext.toString();\r\n  }\r\n\r\n  showLoading() {\r\n    this.loading = this.loadingCtrl.create({\r\n      content: 'Please wait...',\r\n      dismissOnPageChange: true\r\n    });\r\n    this.loading.present();\r\n  }\r\n\r\n  showError(text) {\r\n    this.loading.dismiss();\r\n    let errorMsg = this.getErrorMessage(text)\r\n    let alert = this.alertCtrl.create({\r\n      title: 'Fail',\r\n      subTitle: errorMsg,\r\n      buttons: ['OK']\r\n    });\r\n    alert.present();\r\n  }  \r\n\r\n  getErrorMessage(text): string {\r\n    try {\r\n      var object = JSON.parse(text._body);\r\n      return object.errorMessage;\r\n    } catch (e){\r\n      return text;\r\n    }\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-secret/add-secret.ts"],"sourceRoot":""}